import requests
from itertools import zip_longest
def check_ssti(payloads,value):
    url = "http://localhost/weblabs/ssti/"
    values = {'name': payloads, 'submit': 'submit'}


    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36"}


    targetUrl = requests.get(url=url, params=values, headers=headers)



    if value in targetUrl.text:

        return True

with open(r"C:\Users\sommi\OneDrive\Desktop\payloads\payloads.txt") as textfile1, open(r"C:\Users\sommi\OneDrive\Desktop\payloads\values.txt") as textfile2:
    for x, y in zip_longest(textfile1, textfile2):
        pay = str(x.strip())
        val = str(y.strip())
        s=check_ssti(pay,val)
        if(s):
            print("page is vulnerable to ssti,Inspect Manually Now. payloads worked{}".format(pay))
            break
