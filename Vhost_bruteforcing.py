#The script will help to brute force the vhost along with its dns resolution.
import requests
import socket
wordlist=r'D:\wordlist\SecLists\Discovery\DNS\fierce-hostlist.txt'

def brute_vhost(word):
    headers={'Host':word+'.hackycorp.com'}
    url='http://hackycorp.com'
    r=requests.get(url=url,headers=headers)
    if(r.status_code)==200:
        try:
            socket.getaddrinfo(word+'.hackycorp.com',80)
        except:
            print "No DNS"
            if 'recon_11' in r.text:
                print r.text
                exit(1)
    


with open(wordlist) as fh:
    for word in fh:
        #print word.strip()
        brute_vhost(word.strip())

